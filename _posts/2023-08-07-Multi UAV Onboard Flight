---
title: Multi UAV Onboard Flight
author: soojung son
date: 2023-08-07
category: px4
layout: post
---

PX4 Autopilot: Open Source Autopilot for Drones
https://px4.io/


## 오프보드 모드란?

<관련 문서>

* 비행 모드 - 오프보드 https://docs.px4.io/main/ko/flight_modes/offboard.html

* Drone Apps & APIs - 리눅스 오프보드 제어 https://docs.px4.io/main/ko/ros/offboard_control.html
  
* 하드웨어 - 보조 컴퓨터 설정 : https://docs.px4.io/main/ko/companion_computer/pixhawk_companion.html




## 다중 UAV Onboard 비행 실험 준비 조건

### 1. 텔레메트리 ID 설정

짝이 되는 두 텔레메트리 (드론에 연결된 텔레메트리와 지상국에 연결된 텔레메트리)의 ID를 일치시키고,
서로 다른 드론마다 텔레메트리 ID를 다르게 부여

적용 방법: 

https://ardupilot.org/copter/docs/common-configuring-a-telemetry-radio-using-mission-planner.html

MissionPlanner : 

1. 기체에 텔레메트리 연결 후 배터리 연결

2. 짝궁 텔레메트리를 미션플래너를 실행하는 컴퓨터와 연결
   ※ 미션 플래너에서는 연결 버튼 누르지 않기

3. 미션플래너 : 설정 -> 추가 하드웨어 -> Sik 무선신호 탭

4. Load settings에서 Net ID 변경 : local과 Remote 동일하게
   ※ local : 미션 플래너 컴퓨터와 연결된 텔레메트리
   ※ Remote 파라미터를 바꿀 수 없을 때
     : 기체와 연결된 텔레메트리를 컴퓨터와 연결하고 Local 파라미터에서 Net ID 변경


### 2. MAVROS ID 설정

MAV_SYS_ID와 px4.launch ID 일치 필요

1) MAV_SYS_ID 설정

2) launch파일에서 ID 설정
<arg name="ID" value=" "/>


### 3. px4.launch 에서 udp_url 설정
<arg name="fcu_url" default="/dev/ttyACM0"/>
픽스호크와 연결된 usb port 설정(ex. "/dev/ttyACM0" "/dev/ttyUSB0")


### 4. 각 UAV별 그룹 이름 설정

아래 예시처럼, 각 UAV별 그룹 이름을 설정하여 토픽이 겹치지 않도록 한다.


    <arg name="ns1" default="UAV1"/>
    <arg name="ns2" default="UAV2"/>
    <arg name="ns3" default="UAV3"/>
    <arg name="ns4" default="UAV4"/>
    <arg name="ns5" default="UAV5"/>
    
    <!-- UAV1 -->
    <group ns="$(arg ns1)">

    ....

    <!-- UAV2 -->
    <group ns="$(arg ns2)">


## UAV Onboard 비행 실험 순서


